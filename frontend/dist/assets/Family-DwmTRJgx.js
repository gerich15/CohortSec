import{X as M,r as t,j as e,aa as r,U as I,ad as d,ac as j,m as U,_ as E,ae as F,a1 as L,a2 as c,a3 as R,ag as z}from"./index-BOT2cxnc.js";import{U as y}from"./user-plus-DQIY67QM.js";/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=M("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function V(){const{t:a}=F(),[m,u]=t.useState([]),[b,N]=t.useState(!0),[w,n]=t.useState(!1),[o,v]=t.useState(""),[f,g]=t.useState(""),[k,p]=t.useState(!1),x=()=>{L().then(s=>u(s.data)).catch(()=>{u([]),c.error("Не удалось загрузить семью")}).finally(()=>N(!1))};t.useEffect(()=>{x()},[]);const S=async s=>{var l,i;s.preventDefault(),p(!0);try{await R({email:o,display_name:f||void 0}),c.success("Приглашение отправлено на "+o),n(!1),v(""),g(""),x()}catch(h){const C=(i=(l=h==null?void 0:h.response)==null?void 0:l.data)==null?void 0:i.detail;c.error(C||"Что-то пошло не так")}finally{p(!1)}},_=async s=>{if(confirm("Удалить из семьи?"))try{await z(s),c.success("Удалено"),x()}catch{c.error("Не удалось удалить")}};return b?e.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:e.jsx("p",{className:"text-vg-muted",children:a("common.loading")})}):e.jsxs("div",{className:"space-y-8 max-w-4xl",children:[e.jsx(r,{children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(I,{className:"w-7 h-7 text-vg-accent"}),a("family.title")]}),e.jsx(d,{leftIcon:e.jsx(y,{className:"w-4 h-4"}),onClick:()=>n(!0),disabled:m.length>=5,children:a("family.invite")})]})}),e.jsx(r,{children:e.jsx("p",{className:"text-vg-muted",children:a("family.add_hint")})}),e.jsx(r,{children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[m.map(s=>{var l,i;return e.jsx(j,{className:"p-5 flex flex-col",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-vg-accent/30 flex items-center justify-center text-vg-accent font-semibold",children:((i=(l=s.display_name)==null?void 0:l.charAt(0))==null?void 0:i.toUpperCase())||"?"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.display_name||"Участник"}),e.jsx("p",{className:"text-sm text-vg-muted",children:s.email||"—"})]})]}),e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>_(s.id),children:e.jsx(D,{className:"w-4 h-4 text-vg-danger"})})]})},s.id)}),m.length<5&&e.jsxs(U.div,{whileHover:{scale:1.02},className:"border-2 border-dashed border-vg-accent/40 rounded-xl p-6 flex items-center justify-center cursor-pointer hover:bg-vg-accent/5 transition-colors",onClick:()=>n(!0),children:[e.jsx(y,{className:"w-10 h-10 text-vg-accent mb-2"}),e.jsx("p",{className:"text-vg-muted text-sm",children:"Добавить родственника"})]})]})}),w&&e.jsx(r,{children:e.jsxs(j,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:a("family.invite_title")}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-vg-muted mb-2",children:a("family.invite_email")}),e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-vg-muted"}),e.jsx("input",{type:"email",value:o,onChange:s=>v(s.target.value),required:!0,className:"w-full pl-10 pr-4 py-3 bg-vg-surface border border-white/10 rounded-lg text-white",placeholder:"example@mail.ru"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-vg-muted mb-2",children:a("family.invite_name")}),e.jsx("input",{type:"text",value:f,onChange:s=>g(s.target.value),className:"w-full px-4 py-3 bg-vg-surface border border-white/10 rounded-lg text-white",placeholder:"Мама, Папа, Ребёнок"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(d,{type:"submit",loading:k,children:a("family.invite_send")}),e.jsx(d,{variant:"ghost",type:"button",onClick:()=>n(!1),children:a("common.cancel")})]})]})]})})]})}export{V as default};
