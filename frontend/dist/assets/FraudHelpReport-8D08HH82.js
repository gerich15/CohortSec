import{r as u,aD as b,aE as xe,aa as be,aF as ve,j as a,a as _e,aw as we,N as Se,aG as je,aC as Ne}from"./index-By3V3s7V.js";import{C as Re}from"./circle-check-big-CyibBHzH.js";import{P as Oe}from"./paperclip-B_C-K2TJ.js";var Ee=["sitekey","onChange","theme","type","tabindex","onExpired","onErrored","size","stoken","grecaptcha","badge","hl","isolated"];function J(){return J=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},J.apply(this,arguments)}function Le(e,n){if(e==null)return{};var i={},r=Object.keys(e),t,p;for(p=0;p<r.length;p++)t=r[p],!(n.indexOf(t)>=0)&&(i[t]=e[t]);return i}function z(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ce(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e,ee(e,n)}function ee(e,n){return ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,t){return r.__proto__=t,r},ee(e,n)}var q=function(e){Ce(n,e);function n(){var r;return r=e.call(this)||this,r.handleExpired=r.handleExpired.bind(z(r)),r.handleErrored=r.handleErrored.bind(z(r)),r.handleChange=r.handleChange.bind(z(r)),r.handleRecaptchaRef=r.handleRecaptchaRef.bind(z(r)),r}var i=n.prototype;return i.getCaptchaFunction=function(t){return this.props.grecaptcha?this.props.grecaptcha.enterprise?this.props.grecaptcha.enterprise[t]:this.props.grecaptcha[t]:null},i.getValue=function(){var t=this.getCaptchaFunction("getResponse");return t&&this._widgetId!==void 0?t(this._widgetId):null},i.getWidgetId=function(){return this.props.grecaptcha&&this._widgetId!==void 0?this._widgetId:null},i.execute=function(){var t=this.getCaptchaFunction("execute");if(t&&this._widgetId!==void 0)return t(this._widgetId);this._executeRequested=!0},i.executeAsync=function(){var t=this;return new Promise(function(p,S){t.executionResolve=p,t.executionReject=S,t.execute()})},i.reset=function(){var t=this.getCaptchaFunction("reset");t&&this._widgetId!==void 0&&t(this._widgetId)},i.forceReset=function(){var t=this.getCaptchaFunction("reset");t&&t()},i.handleExpired=function(){this.props.onExpired?this.props.onExpired():this.handleChange(null)},i.handleErrored=function(){this.props.onErrored&&this.props.onErrored(),this.executionReject&&(this.executionReject(),delete this.executionResolve,delete this.executionReject)},i.handleChange=function(t){this.props.onChange&&this.props.onChange(t),this.executionResolve&&(this.executionResolve(t),delete this.executionReject,delete this.executionResolve)},i.explicitRender=function(){var t=this.getCaptchaFunction("render");if(t&&this._widgetId===void 0){var p=document.createElement("div");this._widgetId=t(p,{sitekey:this.props.sitekey,callback:this.handleChange,theme:this.props.theme,type:this.props.type,tabindex:this.props.tabindex,"expired-callback":this.handleExpired,"error-callback":this.handleErrored,size:this.props.size,stoken:this.props.stoken,hl:this.props.hl,badge:this.props.badge,isolated:this.props.isolated}),this.captcha.appendChild(p)}this._executeRequested&&this.props.grecaptcha&&this._widgetId!==void 0&&(this._executeRequested=!1,this.execute())},i.componentDidMount=function(){this.explicitRender()},i.componentDidUpdate=function(){this.explicitRender()},i.handleRecaptchaRef=function(t){this.captcha=t},i.render=function(){var t=this.props;t.sitekey,t.onChange,t.theme,t.type,t.tabindex,t.onExpired,t.onErrored,t.size,t.stoken,t.grecaptcha,t.badge,t.hl,t.isolated;var p=Le(t,Ee);return u.createElement("div",J({},p,{ref:this.handleRecaptchaRef}))},n}(u.Component);q.displayName="ReCAPTCHA";q.propTypes={sitekey:b.string.isRequired,onChange:b.func,grecaptcha:b.object,theme:b.oneOf(["dark","light"]),type:b.oneOf(["image","audio"]),tabindex:b.number,onExpired:b.func,onErrored:b.func,size:b.oneOf(["compact","normal","invisible"]),stoken:b.string,hl:b.string,badge:b.oneOf(["bottomright","bottomleft","inline"]),isolated:b.bool};q.defaultProps={onChange:function(){},theme:"light",type:"image",tabindex:0,size:"normal",badge:"bottomright"};var he={exports:{}},d={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h=typeof Symbol=="function"&&Symbol.for,ae=h?Symbol.for("react.element"):60103,oe=h?Symbol.for("react.portal"):60106,H=h?Symbol.for("react.fragment"):60107,W=h?Symbol.for("react.strict_mode"):60108,G=h?Symbol.for("react.profiler"):60114,K=h?Symbol.for("react.provider"):60109,V=h?Symbol.for("react.context"):60110,se=h?Symbol.for("react.async_mode"):60111,B=h?Symbol.for("react.concurrent_mode"):60111,Q=h?Symbol.for("react.forward_ref"):60112,X=h?Symbol.for("react.suspense"):60113,ke=h?Symbol.for("react.suspense_list"):60120,Y=h?Symbol.for("react.memo"):60115,Z=h?Symbol.for("react.lazy"):60116,Pe=h?Symbol.for("react.block"):60121,Ie=h?Symbol.for("react.fundamental"):60117,Te=h?Symbol.for("react.responder"):60118,$e=h?Symbol.for("react.scope"):60119;function _(e){if(typeof e=="object"&&e!==null){var n=e.$$typeof;switch(n){case ae:switch(e=e.type,e){case se:case B:case H:case G:case W:case X:return e;default:switch(e=e&&e.$$typeof,e){case V:case Q:case Z:case Y:case K:return e;default:return n}}case oe:return n}}}function fe(e){return _(e)===B}d.AsyncMode=se;d.ConcurrentMode=B;d.ContextConsumer=V;d.ContextProvider=K;d.Element=ae;d.ForwardRef=Q;d.Fragment=H;d.Lazy=Z;d.Memo=Y;d.Portal=oe;d.Profiler=G;d.StrictMode=W;d.Suspense=X;d.isAsyncMode=function(e){return fe(e)||_(e)===se};d.isConcurrentMode=fe;d.isContextConsumer=function(e){return _(e)===V};d.isContextProvider=function(e){return _(e)===K};d.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===ae};d.isForwardRef=function(e){return _(e)===Q};d.isFragment=function(e){return _(e)===H};d.isLazy=function(e){return _(e)===Z};d.isMemo=function(e){return _(e)===Y};d.isPortal=function(e){return _(e)===oe};d.isProfiler=function(e){return _(e)===G};d.isStrictMode=function(e){return _(e)===W};d.isSuspense=function(e){return _(e)===X};d.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===H||e===B||e===G||e===W||e===X||e===ke||typeof e=="object"&&e!==null&&(e.$$typeof===Z||e.$$typeof===Y||e.$$typeof===K||e.$$typeof===V||e.$$typeof===Q||e.$$typeof===Ie||e.$$typeof===Te||e.$$typeof===$e||e.$$typeof===Pe)};d.typeOf=_;he.exports=d;var Fe=he.exports,ie=Fe,Ae={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},De={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},Me={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},me={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},ce={};ce[ie.ForwardRef]=Me;ce[ie.Memo]=me;function de(e){return ie.isMemo(e)?me:ce[e.$$typeof]||Ae}var Ue=Object.defineProperty,ze=Object.getOwnPropertyNames,le=Object.getOwnPropertySymbols,qe=Object.getOwnPropertyDescriptor,He=Object.getPrototypeOf,pe=Object.prototype;function ge(e,n,i){if(typeof n!="string"){if(pe){var r=He(n);r&&r!==pe&&ge(e,r,i)}var t=ze(n);le&&(t=t.concat(le(n)));for(var p=de(e),S=de(n),j=0;j<t.length;++j){var g=t[j];if(!De[g]&&!(i&&i[g])&&!(S&&S[g])&&!(p&&p[g])){var N=qe(n,g);try{Ue(e,g,N)}catch{}}}}return e}var We=ge;const Ge=xe(We);function te(){return te=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},te.apply(this,arguments)}function Ke(e,n){if(e==null)return{};var i={},r=Object.keys(e),t,p;for(p=0;p<r.length;p++)t=r[p],!(n.indexOf(t)>=0)&&(i[t]=e[t]);return i}function Ve(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n}var O={},Be=0;function Qe(e,n){return n=n||{},function(r){var t=r.displayName||r.name||"Component",p=function(j){Ve(g,j);function g(w,l){var c;return c=j.call(this,w,l)||this,c.state={},c.__scriptURL="",c}var N=g.prototype;return N.asyncScriptLoaderGetScriptLoaderID=function(){return this.__scriptLoaderID||(this.__scriptLoaderID="async-script-loader-"+Be++),this.__scriptLoaderID},N.setupScriptURL=function(){return this.__scriptURL=typeof e=="function"?e():e,this.__scriptURL},N.asyncScriptLoaderHandleLoad=function(l){var c=this;this.setState(l,function(){return c.props.asyncScriptOnLoad&&c.props.asyncScriptOnLoad(c.state)})},N.asyncScriptLoaderTriggerOnScriptLoaded=function(){var l=O[this.__scriptURL];if(!l||!l.loaded)throw new Error("Script is not loaded.");for(var c in l.observers)l.observers[c](l);delete window[n.callbackName]},N.componentDidMount=function(){var l=this,c=this.setupScriptURL(),f=this.asyncScriptLoaderGetScriptLoaderID(),v=n,s=v.globalName,y=v.callbackName,$=v.scriptId;if(s&&typeof window[s]<"u"&&(O[c]={loaded:!0,observers:{}}),O[c]){var C=O[c];if(C&&(C.loaded||C.errored)){this.asyncScriptLoaderHandleLoad(C);return}C.observers[f]=function(x){return l.asyncScriptLoaderHandleLoad(x)};return}var F={};F[f]=function(x){return l.asyncScriptLoaderHandleLoad(x)},O[c]={loaded:!1,observers:F};var E=document.createElement("script");E.src=c,E.async=!0;for(var I in n.attributes)E.setAttribute(I,n.attributes[I]);$&&(E.id=$);var k=function(P){if(O[c]){var M=O[c],A=M.observers;for(var o in A)P(A[o])&&delete A[o]}};y&&typeof window<"u"&&(window[y]=function(){return l.asyncScriptLoaderTriggerOnScriptLoaded()}),E.onload=function(){var x=O[c];x&&(x.loaded=!0,k(function(P){return y?!1:(P(x),!0)}))},E.onerror=function(){var x=O[c];x&&(x.errored=!0,k(function(P){return P(x),!0}))},document.body.appendChild(E)},N.componentWillUnmount=function(){var l=this.__scriptURL;if(n.removeOnUnmount===!0)for(var c=document.getElementsByTagName("script"),f=0;f<c.length;f+=1)c[f].src.indexOf(l)>-1&&c[f].parentNode&&c[f].parentNode.removeChild(c[f]);var v=O[l];v&&(delete v.observers[this.asyncScriptLoaderGetScriptLoaderID()],n.removeOnUnmount===!0&&delete O[l])},N.render=function(){var l=n.globalName,c=this.props;c.asyncScriptOnLoad;var f=c.forwardedRef,v=Ke(c,["asyncScriptOnLoad","forwardedRef"]);return l&&typeof window<"u"&&(v[l]=typeof window[l]<"u"?window[l]:void 0),v.ref=f,u.createElement(r,v)},g}(u.Component),S=u.forwardRef(function(j,g){return u.createElement(p,te({},j,{forwardedRef:g}))});return S.displayName="AsyncScriptLoader("+t+")",S.propTypes={asyncScriptOnLoad:b.func},Ge(S,r)}}var re="onloadcallback",Xe="grecaptcha";function ne(){return typeof window<"u"&&window.recaptchaOptions||{}}function Ye(){var e=ne(),n=e.useRecaptchaNet?"recaptcha.net":"www.google.com";return e.enterprise?"https://"+n+"/recaptcha/enterprise.js?onload="+re+"&render=explicit":"https://"+n+"/recaptcha/api.js?onload="+re+"&render=explicit"}const Ze=Qe(Ye,{callbackName:re,globalName:Xe,attributes:ne().nonce?{nonce:ne().nonce}:{}})(q),ue=10,Je=10*1024*1024,et="image/*,.pdf,.txt,.doc,.docx";function at(){const[e,n]=u.useState(null),[i,r]=u.useState(!1),[t,p]=u.useState(null),[S,j]=u.useState(""),[g,N]=u.useState(""),[w,l]=u.useState(null),c=u.useRef(null),[f,v]=u.useState([]),[s,y]=u.useState({reporter_name:"",reporter_email:"",reporter_phone:"",description:"",scammer_phone:"",scammer_email:"",scammer_link:"",scammer_nickname:"",scammer_card:"",scheme_type:"",consent_given:!1}),[$,C]=u.useState(""),[F,E]=u.useState(!1),[I,k]=u.useState(null);u.useEffect(()=>{sessionStorage.getItem("token")&&be().then(o=>n({full_name:o.data.full_name,email:o.data.email})).catch(()=>{})},[]),u.useEffect(()=>{ve().then(o=>N(o.data.recaptcha_site_key||"")).catch(()=>{})},[]),u.useEffect(()=>{e&&y(o=>({...o,reporter_name:e.full_name||"",reporter_email:e.email||""}))},[e]);const x=o=>{const R=Array.from(o.target.files||[]),T=[];for(const L of R)L.size<=Je&&T.push(L);v(L=>[...L,...T].slice(0,ue)),o.target.value=""},P=o=>{v(R=>R.filter((T,L)=>L!==o))},M=async()=>{const o=$.trim();if(o.length<4){k({found:!1,count:0,message:"Введите минимум 4 символа"});return}E(!0),k(null);try{const{data:R}=await je(o);k(R)}catch{k({found:!1,count:0,message:"Ошибка поиска"})}finally{E(!1)}},A=async o=>{var R,T,L;o.preventDefault(),j(""),r(!0);try{const m=new FormData;m.append("reporter_name",s.reporter_name),m.append("reporter_email",s.reporter_email),s.reporter_phone&&m.append("reporter_phone",s.reporter_phone),m.append("description",s.description),s.scammer_phone&&m.append("scammer_phone",s.scammer_phone),s.scammer_email&&m.append("scammer_email",s.scammer_email),s.scammer_link&&m.append("scammer_link",s.scammer_link),s.scammer_nickname&&m.append("scammer_nickname",s.scammer_nickname),s.scammer_card&&m.append("scammer_card",s.scammer_card),s.scheme_type&&m.append("scheme_type",s.scheme_type),m.append("consent_given",String(s.consent_given)),w&&m.append("recaptcha_token",w);for(const U of f)m.append("files",U);const{data:D}=await Ne.post("/fraud-help/report",m,{headers:{"Content-Type":void 0},transformRequest:[(U,ye)=>(U instanceof FormData&&delete ye["Content-Type"],U)]});p(D.ticket_number)}catch(m){const D=m;j(((T=(R=D==null?void 0:D.response)==null?void 0:R.data)==null?void 0:T.detail)||"Ошибка отправки."),(L=c.current)==null||L.reset(),l(null)}finally{r(!1)}};return t?a.jsx("div",{className:"space-y-8",children:a.jsxs("div",{className:"rounded-xl bg-green-500/10 border border-green-500/30 p-8 text-center",children:[a.jsx(Re,{className:"w-16 h-16 text-green-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Спасибо!"}),a.jsxs("p",{className:"text-vg-muted mb-2",children:["Номер обращения: #",t]}),a.jsx(_e,{to:"/fraud-help",className:"inline-block mt-6 text-vg-accent hover:underline",children:"Вернуться"})]})}):a.jsxs("div",{className:"space-y-8",children:[a.jsx("h1",{className:"text-3xl md:text-4xl font-bold gradient-text",children:"Сообщить о мошеннике"}),a.jsxs("div",{className:"rounded-xl border border-white/10 bg-vg-surface/30 p-6 space-y-3",children:[a.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[a.jsx(we,{className:"w-5 h-5"}),"Проверить в базе"]}),a.jsx("p",{className:"text-sm text-vg-muted",children:"Введите номер телефона, email или карты — мы покажем, упоминался ли он в обращениях."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",placeholder:"+7 999 123-45-67 или email@example.com",value:$,onChange:o=>C(o.target.value),onKeyDown:o=>o.key==="Enter"&&M(),className:"flex-1 px-4 py-3 bg-vg-bg border border-white/10 rounded-lg text-white placeholder-vg-muted"}),a.jsx("button",{type:"button",onClick:M,disabled:F,className:"px-4 py-3 bg-vg-accent text-black font-medium rounded-lg hover:opacity-90 disabled:opacity-50",children:F?"Поиск...":"Проверить"})]}),I&&a.jsx("p",{className:I.found?"text-amber-400 text-sm":"text-vg-muted text-sm",children:I.message})]}),a.jsxs("form",{onSubmit:A,className:"space-y-6",children:[a.jsxs("div",{className:"rounded-xl border border-white/10 bg-vg-surface/30 p-6 space-y-4",children:[a.jsx("h3",{className:"font-semibold",children:"Ваши данные"}),a.jsx("input",{type:"text",required:!0,placeholder:"Ваше имя *",value:s.reporter_name,onChange:o=>y({...s,reporter_name:o.target.value}),className:"w-full px-4 py-3 bg-vg-bg border border-white/10 rounded-lg text-white placeholder-vg-muted"}),a.jsx("input",{type:"email",required:!0,placeholder:"Email *",value:s.reporter_email,onChange:o=>y({...s,reporter_email:o.target.value}),className:"w-full px-4 py-3 bg-vg-bg border border-white/10 rounded-lg text-white placeholder-vg-muted"}),a.jsx("input",{type:"tel",placeholder:"Телефон",value:s.reporter_phone,onChange:o=>y({...s,reporter_phone:o.target.value}),className:"w-full px-4 py-3 bg-vg-bg border border-white/10 rounded-lg text-white placeholder-vg-muted"})]}),a.jsxs("div",{className:"rounded-xl border border-white/10 bg-vg-surface/30 p-6 space-y-4",children:[a.jsx("h3",{className:"font-semibold",children:"Что случилось? *"}),a.jsx("textarea",{required:!0,minLength:10,rows:5,placeholder:"Опишите ситуацию",value:s.description,onChange:o=>y({...s,description:o.target.value}),className:"w-full px-4 py-3 bg-vg-bg border border-white/10 rounded-lg text-white placeholder-vg-muted resize-none"}),a.jsxs("div",{children:[a.jsxs("label",{className:"block font-medium text-sm mb-2",children:["Документы (до ",ue," файлов, макс. 10 МБ):"]}),a.jsx("input",{type:"file",multiple:!0,accept:et,onChange:x,className:"hidden",id:"fraud-files"}),a.jsxs("label",{htmlFor:"fraud-files",className:"inline-flex items-center gap-2 px-4 py-2 bg-vg-bg border border-white/10 rounded-lg cursor-pointer hover:bg-white/5 text-vg-muted text-sm",children:[a.jsx(Oe,{className:"w-4 h-4"}),f.length>0?`${f.length} файлов`:"Выбрать файлы"]}),f.length>0&&a.jsx("ul",{className:"mt-2 space-y-1 text-sm text-vg-muted",children:f.map((o,R)=>a.jsxs("li",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"truncate max-w-[200px]",children:o.name}),a.jsx("button",{type:"button",onClick:()=>P(R),className:"text-red-400 hover:underline",children:"Удалить"})]},R))})]})]}),a.jsxs("div",{className:"rounded-xl border border-white/10 bg-vg-surface/30 p-6 space-y-4",children:[a.jsx("h3",{className:"font-semibold",children:"Данные мошенника"}),a.jsx("input",{type:"tel",placeholder:"Номер телефона",value:s.scammer_phone,onChange:o=>y({...s,scammer_phone:o.target.value}),className:"w-full px-4 py-3 bg-vg-bg border border-white/10 rounded-lg text-white placeholder-vg-muted"}),a.jsx("input",{type:"email",placeholder:"Email",value:s.scammer_email,onChange:o=>y({...s,scammer_email:o.target.value}),className:"w-full px-4 py-3 bg-vg-bg border border-white/10 rounded-lg text-white placeholder-vg-muted"}),a.jsx("input",{type:"url",placeholder:"Ссылка на соцсеть",value:s.scammer_link,onChange:o=>y({...s,scammer_link:o.target.value}),className:"w-full px-4 py-3 bg-vg-bg border border-white/10 rounded-lg text-white placeholder-vg-muted"}),a.jsx("input",{type:"text",placeholder:"Никнейм",value:s.scammer_nickname,onChange:o=>y({...s,scammer_nickname:o.target.value}),className:"w-full px-4 py-3 bg-vg-bg border border-white/10 rounded-lg text-white placeholder-vg-muted"}),a.jsx("input",{type:"text",placeholder:"Номер карты или кошелька",value:s.scammer_card,onChange:o=>y({...s,scammer_card:o.target.value}),className:"w-full px-4 py-3 bg-vg-bg border border-white/10 rounded-lg text-white placeholder-vg-muted"})]}),g&&a.jsx("div",{className:"flex justify-start",children:a.jsx(Ze,{ref:c,sitekey:g,onChange:o=>l(o),onExpired:()=>l(null),theme:"dark"})}),a.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg bg-white/5 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:s.consent_given,onChange:o=>y({...s,consent_given:o.target.checked}),className:"mt-1"}),a.jsx("span",{className:"text-sm text-vg-muted",children:"Даю согласие на обработку персональных данных. Информация может быть передана в соответствующие органы. *"})]}),S&&a.jsx("p",{className:"text-red-400 text-sm",children:S}),a.jsxs("button",{type:"submit",disabled:i||!s.consent_given,className:"inline-flex items-center gap-2 px-6 py-3 bg-red-500/20 hover:bg-red-500/30 border border-red-500/40 text-red-400 font-semibold rounded-xl disabled:opacity-50",children:[a.jsx(Se,{className:"w-5 h-5"}),i?"Отправка...":"Отправить обращение"]})]})]})}export{at as default};
