import{r as t,j as e,ae as n,U as M,ah as m,ag as j,m as U,a0 as E,aj as F,a4 as I,a5 as c,a6 as R,al as z}from"./index-By3V3s7V.js";import{U as b}from"./user-plus-DvCH32F7.js";import{T as D}from"./trash-2-D-KNdMYF.js";function A(){const{t:a}=F(),[d,u]=t.useState([]),[y,N]=t.useState(!0),[w,r]=t.useState(!1),[o,f]=t.useState(""),[v,g]=t.useState(""),[S,p]=t.useState(!1),x=()=>{I().then(s=>u(s.data)).catch(()=>{u([]),c.error("Не удалось загрузить семью")}).finally(()=>N(!1))};t.useEffect(()=>{x()},[]);const C=async s=>{var l,i;s.preventDefault(),p(!0);try{await R({email:o,display_name:v||void 0}),c.success("Приглашение отправлено на "+o),r(!1),f(""),g(""),x()}catch(h){const k=(i=(l=h==null?void 0:h.response)==null?void 0:l.data)==null?void 0:i.detail;c.error(k||"Что-то пошло не так")}finally{p(!1)}},_=async s=>{if(confirm("Удалить из семьи?"))try{await z(s),c.success("Удалено"),x()}catch{c.error("Не удалось удалить")}};return y?e.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:e.jsx("p",{className:"text-vg-muted",children:a("common.loading")})}):e.jsxs("div",{className:"space-y-8 max-w-4xl",children:[e.jsx(n,{children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(M,{className:"w-7 h-7 text-vg-accent"}),a("family.title")]}),e.jsx(m,{leftIcon:e.jsx(b,{className:"w-4 h-4"}),onClick:()=>r(!0),disabled:d.length>=5,children:a("family.invite")})]})}),e.jsx(n,{children:e.jsx("p",{className:"text-vg-muted",children:a("family.add_hint")})}),e.jsx(n,{children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[d.map(s=>{var l,i;return e.jsx(j,{className:"p-5 flex flex-col",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-vg-accent/30 flex items-center justify-center text-vg-accent font-semibold",children:((i=(l=s.display_name)==null?void 0:l.charAt(0))==null?void 0:i.toUpperCase())||"?"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.display_name||"Участник"}),e.jsx("p",{className:"text-sm text-vg-muted",children:s.email||"—"})]})]}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>_(s.id),children:e.jsx(D,{className:"w-4 h-4 text-vg-danger"})})]})},s.id)}),d.length<5&&e.jsxs(U.div,{whileHover:{scale:1.02},className:"border-2 border-dashed border-vg-accent/40 rounded-xl p-6 flex items-center justify-center cursor-pointer hover:bg-vg-accent/5 transition-colors",onClick:()=>r(!0),children:[e.jsx(b,{className:"w-10 h-10 text-vg-accent mb-2"}),e.jsx("p",{className:"text-vg-muted text-sm",children:"Добавить родственника"})]})]})}),w&&e.jsx(n,{children:e.jsxs(j,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:a("family.invite_title")}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-vg-muted mb-2",children:a("family.invite_email")}),e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-vg-muted"}),e.jsx("input",{type:"email",value:o,onChange:s=>f(s.target.value),required:!0,className:"w-full pl-10 pr-4 py-3 bg-vg-surface border border-white/10 rounded-lg text-white",placeholder:"example@mail.ru"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-vg-muted mb-2",children:a("family.invite_name")}),e.jsx("input",{type:"text",value:v,onChange:s=>g(s.target.value),className:"w-full px-4 py-3 bg-vg-surface border border-white/10 rounded-lg text-white",placeholder:"Мама, Папа, Ребёнок"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(m,{type:"submit",loading:S,children:a("family.invite_send")}),e.jsx(m,{variant:"ghost",type:"button",onClick:()=>r(!1),children:a("common.cancel")})]})]})]})})]})}export{A as default};
